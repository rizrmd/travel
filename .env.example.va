# ============================================================================
# VIRTUAL ACCOUNT INTEGRATION (Midtrans)
# Integration 4: Virtual Account Payment Gateway
# ============================================================================

# Enable Virtual Account Integration
# Set to 'true' after obtaining Midtrans credentials
# Default: false (STUB mode - returns mock VA numbers for testing)
VA_ENABLED=false

# Midtrans Credentials
# Get these from: https://dashboard.midtrans.com/settings/config_info
# Server Key: Used for API authentication
# Client Key: Used for frontend integration (optional)
MIDTRANS_SERVER_KEY=your_server_key_here
MIDTRANS_CLIENT_KEY=your_client_key_here

# Midtrans API URL
# Sandbox: https://api.sandbox.midtrans.com/v2
# Production: https://api.midtrans.com/v2
MIDTRANS_API_URL=https://api.sandbox.midtrans.com/v2

# Midtrans App URL (for dashboard links)
# Sandbox: https://app.sandbox.midtrans.com
# Production: https://app.midtrans.com
MIDTRANS_APP_URL=https://app.sandbox.midtrans.com

# ============================================================================
# VIRTUAL ACCOUNT CONFIGURATION
# ============================================================================

# VA Expiry Time (hours)
# Default: 24 hours
# How long a VA remains active before expiring
VA_EXPIRY_HOURS=24

# Auto-create VA when jamaah is created
# Set to 'true' to automatically generate VA for new jamaah
# Default: false (create VA manually via API)
VA_AUTO_CREATE=false

# Default bank for auto-created VAs
# Options: bca, mandiri, bni, bri, permata
# Default: bca
VA_DEFAULT_BANK=bca

# ============================================================================
# WEBHOOK CONFIGURATION
# ============================================================================

# Webhook URL (configure this in Midtrans dashboard)
# Format: https://your-domain.com/virtual-accounts/webhook
# This is where Midtrans sends payment notifications
# WEBHOOK_URL=https://your-domain.com/virtual-accounts/webhook

# ============================================================================
# NOTIFICATION CONFIGURATION
# ============================================================================

# Enable email notifications for successful payments
# Default: true
VA_EMAIL_NOTIFICATIONS=true

# Enable WebSocket notifications for real-time updates
# Default: true
VA_WEBSOCKET_NOTIFICATIONS=true

# ============================================================================
# TESTING & DEVELOPMENT
# ============================================================================

# Test Mode
# When VA_ENABLED=false, the system runs in STUB mode:
# - Creates mock VA numbers (realistic format per bank)
# - No actual API calls to Midtrans
# - Webhook signature validation is bypassed
# - Perfect for local development and testing

# Supported Banks in STUB Mode:
# - BCA: 11-digit VA numbers
# - Mandiri: 14-digit VA numbers (company code + unique)
# - BNI: 10-digit VA numbers
# - BRI: 14-digit VA numbers
# - Permata: 13-digit VA numbers

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================

# Before enabling VA_ENABLED=true in production:
#
# 1. Obtain Production Credentials from Midtrans
#    - Register at https://dashboard.midtrans.com
#    - Complete KYB (Know Your Business) verification
#    - Get production server key and client key
#
# 2. Configure Webhook URL in Midtrans Dashboard
#    - Go to Settings > Configuration
#    - Set Notification URL to: https://your-domain.com/virtual-accounts/webhook
#    - Enable HTTP notification
#
# 3. Update Environment Variables
#    - Set VA_ENABLED=true
#    - Set MIDTRANS_SERVER_KEY to production key
#    - Set MIDTRANS_API_URL to production URL
#
# 4. Test Integration
#    - Create test VA via API
#    - Make test payment using Midtrans simulator
#    - Verify webhook is received and payment is created
#    - Check notifications are sent (email, WebSocket)
#
# 5. Monitor & Alerts
#    - Set up monitoring for failed webhook processing
#    - Configure alerts for stuck payment notifications
#    - Monitor VA expiry job execution
#
# 6. Bank Account Setup
#    - Ensure you have merchant accounts with desired banks
#    - Configure each bank in Midtrans dashboard
#    - Test VA creation for each bank
#
# ============================================================================
# COST OPTIMIZATION
# ============================================================================

# Transaction Fees (Midtrans):
# - BCA: 2.5% - 3.0% per transaction
# - Mandiri: 2.5% - 3.0% per transaction
# - BNI: 2.5% - 3.0% per transaction
# - BRI: 2.5% - 3.0% per transaction
# - Permata: 2.5% - 3.0% per transaction

# Fee Optimization Tips:
# 1. Negotiate volume discounts with Midtrans
# 2. Choose banks with lowest fees for your target market
# 3. Set minimum payment amounts to reduce small transaction fees
# 4. Enable VA expiry to avoid unused VAs
# 5. Monitor and close unused VAs regularly

# ============================================================================
